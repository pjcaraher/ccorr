{% extends 'base.html' %}

{% block container %}
<script>
function isJobIdInList(jobId, list) {
    var jobIds = list.split(",");
    var isInList = false;
    var arrayLength = jobIds.length;
    for (var i = 0; i < arrayLength; i++) {
    	if (jobIds[i] == jobId) {
    		isInList = true;
    		break;
	}
    }

    return isInList;
}

function openNav(vendor) {
    document.getElementById("mySidenav").style.width = "600px";
    document.getElementById("main").style.marginRight = "600px";
    document.body.style.backgroundColor = "rgba(0,0,0,0.4)";
    if (vendor) {
        document.getElementById("vendorId").value = vendor.id;
        document.getElementById('vendorForm').action = "http://localhost:8888/updateVendor";
        document.getElementById("saveButton").text = "Update";
        document.getElementById('name').value = vendor.name;
        document.getElementById('contact').value = vendor.contact;
        document.getElementById('phone').value = vendor.phone;
        document.getElementById('emailList').value = vendor.emailList;
	{% for Job in Jobs %}
        	document.getElementById("jobId_{{ Job.id }}").checked = isJobIdInList({{ Job.id}}, vendor.jobIds)
	{% endfor %}
    } else {
        document.getElementById('vendorForm').action = "http://localhost:8888/createVendor";
        document.getElementById("saveButton").text = "Create New Vendor";
        document.getElementById('name').value = "";
        document.getElementById('contact').value = "";
        document.getElementById('phone').value = "";
        document.getElementById('emailList').value = "";
	{% for Job in Jobs %}
        	document.getElementById("jobId_{{ Job.id }}").checked = false;
	{% endfor %}
    }
}

function closeNav() {
    document.getElementById("mySidenav").style.width = "0";
    document.getElementById("main").style.marginRight= "0";
    document.body.style.backgroundColor = "white";
}
</script>


<div id="mySidenav"  class="sidenav"> 
  <form id="vendorForm" action="http://localhost:8888/updateVendor" method="POST">
  <div class="containerleft containereditvendors">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <h2>Create/Edit Vendor</h2>
    <input type="hidden" id="vendorId" name="vendorId"/>
    <label for="VendorName">Vendor Name</label>
    <input id="name" name="name">
    <label for="Contact">Contact</label>
    <input id="contact" name="contact">
    <label for="Phone">Phone</label>
    <input id="phone" name="phone">
    <label for="Email">Email</label>
    <input id="emailList" name="emailList">


    <h4>Vendor Jobs</h4>
{% for Job in Jobs %}
    <label class="checkboxcontainer">{{ Job.name }}
      <input type="checkbox" id="jobId_{{ Job.id }}" name="jobId_{{ Job.id }}">
      <span class="checkmark"></span>
    </label>
{% endfor %}

    <div class="bttnright bttnrightbottom">
      <a class="bttn bttn2" onclick="closeNav()">Cancel</a>
      <a class="bttn" id="saveButton" href="#" onclick="document.getElementById('vendorForm').submit();">Create New Vendor</a>
    </div>
  </div>
  </form>
</div>





<div class="containerleft containervendors" id="main">
  <h1>Vendors</h1>

  <div class="bttnright bttnabovetable">
    <a class="bttn" onclick="openNav()">Create New Vendor</a>
  </div>

  <h3>Vendors</h3>
    <main>
      <div role="region" aria-labeledby="Cap1" tabindex="0" class="table">
        <table class="jobs">
          {% for Vendor in Vendors %}
          	<tr>
            		<td>{{ Vendor.name }}</td>   
            		<td><a class="bttn" onclick="openNav({{ Vendor.asDict() }})">Open</a></td>
          	</tr>
          {% endfor %}
        </table>
      </div>
    </main>
</div>
{% endblock %}
